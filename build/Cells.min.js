(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?factory(exports):typeof define==="function"&&define.amd?define(["exports"],factory):factory(global.CELL=global.CELL||{})})(this,function(exports){"use strict";var _config={themesPrefix:"d1012"};var global={};Object.defineProperty(global,"config",{get:function(){return _config},set:function(config){Object.assign(_config,config)}});if(!Object.assign){Object.assign=function(src,target){if(!target){return src}Object.keys(target).forEach(function(key){src[key]=target[key]});return src}}function Class(){}Class.create=function(baseClass){var base=new Class;var _initHooks=[];var clazz=function(){var args=arguments;if(typeof baseClass==="function"){baseClass.apply(this,args)}else{Object.keys(baseClass).forEach(function(key){this[key]=baseClass[key]}.bind(this))}_initHooks.forEach(function(initHook){try{initHook.apply(this,args)}catch(e){console.log(e.stack||e)}}.bind(this))};clazz.addInitHooks=function(initHook){var index=_initHooks.indexOf(initHook);if(index===-1){_initHooks.push(initHook)}};clazz.removeInitHooks=function(initHook){var index=_initHooks.indexOf(initHook);if(index>=0){_initHooks.splice(index,1)}};clazz.prototype=base;return clazz};function getMousePosition(e,referElement){var touches=e["touches"];if(touches&&touches.length>0){e=touches[0]}var pageX=e.pageX||e.clientX,pageY=e.pageY||e.clientY;if(isDomElement(referElement)){var bound=referElement.getBoundingClientRect();pageY=pageY-bound.top,pageX=pageX-bound.left}return{pageX:pageX,pageY:pageY}}function isDomElement(object){if(!object){return false}var tagName=object.tagName;if(!tagName){return false}var ele=document.createElement(tagName);if(ele.__proto__){return ele.__proto__===object.__proto__}return Object.keys(ele).every(function(key){return object["hasOwnProperty"](key)})}function isTouchSupported(){return document["ontouchstart"]!==undefined}var requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(executor){return setTimeout(executor,1e3/60)};var cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.clearTimeout;var _timeoutCache={};function executeFunctionDelay(timeoutId,func,context){if(typeof func!=="function"){return}context=context||this;cancelAnimationFrame(_timeoutCache[timeoutId]);return _timeoutCache[timeoutId]=requestAnimationFrame(func.bind(context))}function isElementInDom(element){return document.contains(element)}function getFullClassName(className){var themesPrefix=global.config.themesPrefix;if(!className){return themesPrefix}return themesPrefix+"-"+className}function getFullClassSelector(selector){return"."+getFullClassName(selector)}var browseCssPrefixes=["-webkit-","-moz-","-ms-"];Object.freeze(browseCssPrefixes);var cssPropNames=["transform","transition","animate"];function style(ele,style){if(arguments.length===3){ele.style[style]=arguments[2];return}Object.keys(style).forEach(function(key){if(cssPropNames.indexOf(key)>=0){browseCssPrefixes.forEach(function(prefix){ele.style[prefix+key]=style[key]})}ele.style[key]=style[key]})}function userSelect(selected,ele){ele=ele||document.body;ele.setAttribute("user_select",String(selected))}var scrollbarId=1;function ScrollBar(ele,config){this._id="_id"+scrollbarId++;this.init(ele,config)}ScrollBar.mouseupListeners=null;ScrollBar.mousemoveListeners=null;ScrollBar.initEventListeners=function(){if(!ScrollBar.mouseupListeners){ScrollBar.mouseupListeners={};ScrollBar.mousemoveListeners={};document.body.addEventListener("mouseup",function(evt){var _=this;Object.keys(ScrollBar.mouseupListeners).forEach(function(key){var listener=ScrollBar.mouseupListeners[key];try{listener.call(_,evt)}catch(e){}})},true);document.body.addEventListener("mousemove",function(evt){var _=this;Object.keys(ScrollBar.mousemoveListeners).forEach(function(key){var listener=ScrollBar.mousemoveListeners[key];try{listener.call(_,evt)}catch(e){}})},true)}};function getWidth(ele){var style$$1=window.getComputedStyle(ele);var value=0;["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth","width"].forEach(function(key){value+=parseFloat(style$$1[key])||0});return value}function getClientWidth(ele){return ele.clientWidth}function getScrollWidth(element){var children=element.children;var length=children.length,width=0,ele;if(length>0){for(var i=0;i<length;i++){ele=children[i];if(ele.vScrollbar||ele.hScrollbar){continue}width+=Math.max(ele.scrollWidth,ele.offsetWidth)}}return Math.max(element.scrollWidth,element.clientWidth,width)}function getHeight(ele){var style$$1=window.getComputedStyle(ele);var value=0;["paddingTop","paddingBottom","borderTopWidth","borderBottomWidth","height"].forEach(function(key){value+=parseFloat(style$$1[key])||0});return value}function getClientHeight(ele){return ele.clientHeight}function getScrollHeight(element){var children=element.children;var length=children.length,height=0,ele;if(length>0){for(var i=0;i<length;i++){ele=children[i];if(ele.vScrollbar||ele.hScrollbar){continue}height+=Math.max(ele.scrollHeight,ele.offsetHeight)}}return Math.max(element.scrollHeight,element.clientHeight,height)}ScrollBar.prototype.init=function(ele,config){this.element=ele;this._scrollWidth=0;this.clientWidth=0;this._scrollHeight=0;this.clientHeight=0;this._scrollTop=0;this._scrollLeft=0;var _=this;Object.defineProperty(this,"scrollTop",{set:function(val){_.scrollTopTo(val)},get:function(){return _.scrollTopTo()}});Object.defineProperty(this,"scrollLeft",{set:function(val){_.scrollLeftTo(val)},get:function(){return _.scrollLeftTo()}});Object.defineProperty(this,"scrollWidth",{set:function(val){_._setScrollWidth(val)},get:function(){return _._getScrollWidth()}});Object.defineProperty(this,"scrollHeight",{set:function(val){_._setScrollHeight(val)},get:function(){return _._getScrollHeight()}});this.overflowX=true;this.overflowY=true;this.config=Object.assign({overflowX:false,overflowY:false,width:12,hTrackColor:"#e4f0e2",hScrollColor:"#ddd",vTrackColor:"#e4f0e2",vScrollColor:"#ddd",height:12},config);this.eventListeners={};this.vScrollbar=null;this.hScrollbar=null;ScrollBar.initEventListeners();this.initUI()};ScrollBar.prototype.initUI=function(){style(this.element,{overflow:"hidden"});this._renderV();this._renderH();this.syncScrollbarSize();this._bindScrollEvent()};ScrollBar.prototype.syncScrollbarSize=function(){executeFunctionDelay(this._id+"syncScrollSize",function(){var width=Math.max(getWidth(this.vScrollbar),this.vScrollbar.offsetWidth);this.config.width=Math.max(width,this.config.width);var height=Math.max(getHeight(this.hScrollbar),this.hScrollbar.offsetHeight);this.config.height=Math.max(height,this.config.height)},this)};ScrollBar.prototype.triggerScrollEvent=function(){var scrollEvtKey=this._id+"scroll";executeFunctionDelay(scrollEvtKey,function(){this.triggerEvent("scroll")},this)};ScrollBar.prototype.resize=function(){this.updateScrollSize();var bar;if(this.hScrollbar){bar=this.hScrollbar.children[0];var barWidth=this.getScrollbarWidth();style(bar,{width:barWidth+"px"});style(this.hScrollbar,{display:this.config.overflowX||this.overflowX?"none":"block"})}if(this.vScrollbar){bar=this.vScrollbar.children[0];var barHeight=this.getScrollbarHeight();style(bar,{height:barHeight+"px"});style(this.vScrollbar,{display:this.config.overflowY||this.overflowY?"none":"block"})}this.refresh()};ScrollBar.prototype.refresh=function(){this.scrollLeft=this.scrollLeft;this.scrollTop=this.scrollTop};ScrollBar.prototype.updateScrollSize=function(){var clientWidth=getClientWidth(this.element),scrollWidth=getScrollWidth(this.element);var clientHeight=getClientHeight(this.element),scrollHeight=getScrollHeight(this.element);this.overflowX=scrollWidth<=clientWidth;this.overflowY=scrollHeight<=clientHeight;this.clientWidth=clientWidth;this.clientHeight=clientHeight;this.scrollWidth=scrollWidth;this.scrollHeight=scrollHeight};ScrollBar.prototype._setScrollWidth=function(scrollWidth){this._scrollWidth=scrollWidth};ScrollBar.prototype._getScrollWidth=function(){var scrollWidth=this._scrollWidth;if(!this.overflowY){scrollWidth+=this.config.width}return scrollWidth};ScrollBar.prototype._setScrollHeight=function(scrollHeight){this._scrollHeight=scrollHeight};ScrollBar.prototype._getScrollHeight=function(){var scrollHeight=this._scrollHeight;if(!this.overflowX){scrollHeight+=this.config.height}return scrollHeight};ScrollBar.prototype._createScrollBarBlock=function(){var bar=document.createElement("div");bar.className=getFullClassName("scrollbar-block");return bar};ScrollBar.prototype._renderH=function(){var dom=document.createElement("div");dom.hScrollbar=true;this.hScrollbar=dom;dom.className=getFullClassName("scrollbar-hor");style(dom,{height:this.config.height+"px",display:"none","background-color":this.config.hTrackColor});var bar=this._createScrollBarBlock();style(bar,{"background-color":this.config.hScrollColor});dom.appendChild(bar);this.element.appendChild(dom)};ScrollBar.prototype.addEventListener=function(eventType,listener){var listeners=this.eventListeners[eventType];if(!listeners){listeners=this.eventListeners[eventType]=[]}listeners.push(listener)};ScrollBar.prototype.triggerEvent=function(eventType){var listeners=this.eventListeners[eventType];if(!listeners){return}listeners.forEach(function(listener){try{listener.call(this)}catch(e){console.error(e.stack||e)}}.bind(this))};ScrollBar.prototype._bindHorEvent=function(){var bar=this.hScrollbar.children[0];var startX,relativeLeft;bar.addEventListener("mousedown",function(e){e.stopPropagation();var pos=getMousePosition(e);startX=pos.pageX;relativeLeft=parseFloat(bar.style.left)||0;userSelect(false)}.bind(this));var eventKey=this._id+"hor";ScrollBar.mousemoveListeners[eventKey]=function(e){if(!startX){return}e.stopPropagation();var pos=getMousePosition(e);var left=relativeLeft+pos.pageX-startX;this.scrollLeft=this.getHScrollRatio()*left}.bind(this);ScrollBar.mouseupListeners[eventKey]=function(){startX=relativeLeft=undefined;userSelect(true);if(!isElementInDom(this.element)){delete ScrollBar.mousemoveListeners[eventKey];delete ScrollBar.mouseupListeners[eventKey]}}.bind(this)};ScrollBar.prototype.getHScrollRatio=function(){var barWidth=this.getScrollbarWidth();var scrollRatio=(this.scrollWidth-this.clientWidth)/(this.clientWidth-barWidth);return scrollRatio};ScrollBar.prototype.getVScrollRatio=function(){var barHeight=this.getScrollbarHeight();var scrollRatio=(this.scrollHeight-this.clientHeight)/(this.clientHeight-barHeight);return scrollRatio};ScrollBar.prototype.scrollLeftTo=function(scrollLeft){var maxScrollLeft=this.scrollWidth-this.clientWidth;if(arguments.length===0){this._scrollLeft=Math.min(maxScrollLeft,this._scrollLeft);this._scrollLeft=Math.max(0,this._scrollLeft);return this._scrollLeft}scrollLeft=Math.min(maxScrollLeft,scrollLeft);scrollLeft=Math.max(0,scrollLeft);var scrollRatio=this.getHScrollRatio();var barLeft=scrollLeft/scrollRatio;var bar=this.hScrollbar.children[0];style(bar,{left:barLeft+"px"});this._scrollLeft=scrollLeft;this._getContentChildren().forEach(function(ele){style(ele,{left:-scrollLeft+"px"})});this.triggerScrollEvent()};ScrollBar.prototype._getContentChildren=function(){var children=this.element.children,length=children.length;var elements=[],ele;for(var i=0;i<length;i++){ele=children[i];if(ele.vScrollbar||ele.hScrollbar){continue}elements.push(ele)}return elements};ScrollBar.prototype.scrollTopTo=function(scrollTop){var maxScrollTop=this.scrollHeight-this.clientHeight;if(arguments.length===0){this._scrollTop=Math.min(maxScrollTop,this._scrollTop);this._scrollTop=Math.max(0,this._scrollTop);return this._scrollTop}var maxScrollTop=this.scrollHeight-this.clientHeight;scrollTop=Math.min(maxScrollTop,scrollTop);scrollTop=Math.max(0,scrollTop);var scrollRatio=this.getVScrollRatio();var barTop=scrollTop/scrollRatio;var bar=this.vScrollbar.children[0];style(bar,{top:barTop+"px"});this._scrollTop=scrollTop;this._getContentChildren().forEach(function(ele){style(ele,{top:-scrollTop+"px"})});this.triggerScrollEvent()};ScrollBar.prototype._bindVerEvent=function(){var bar=this.vScrollbar.children[0];var startY,relativeTop;bar.addEventListener("mousedown",function(e){e.stopPropagation();var pos=getMousePosition(e);startY=pos.pageY;relativeTop=parseFloat(bar.style.top)||0;userSelect(false)}.bind(this));var eventKey=this._id+"ver";ScrollBar.mousemoveListeners[eventKey]=function(e){if(!startY){return}e.stopPropagation();var pos=getMousePosition(e);var top=relativeTop+pos.pageY-startY;this.scrollTop=this.getVScrollRatio()*top}.bind(this);ScrollBar.mouseupListeners[eventKey]=function(){startY=relativeTop=undefined;userSelect(true);if(!isElementInDom(this.element)){delete ScrollBar.mousemoveListeners[eventKey];delete ScrollBar.mouseupListeners[eventKey]}}.bind(this)};ScrollBar.prototype._bindScrollEvent=function(){this._bindHorEvent();this._bindVerEvent();this._bindMouseWheelEvent();this._bindTouchScrollEvent()};function isDefined(val){return val!==undefined}function getWheelData(e,type){var value;if(isDefined(value=e["delta"+type])){return value}if(isDefined(value=e["wheelDelta"+type])){return value}if(isDefined(value=e["wheelDelta"])){return value/40}if(isDefined(value=e.detail)){return value}return value}ScrollBar.prototype._bindMouseWheelEvent=function(){var _=this;function wheelEvent(e){var lengthX=_.overflowX?0:getWheelData(e,"X"),lengthY=_.overflowY?0:getWheelData(e,"Y");if(Math.abs(lengthX)>Math.abs(lengthY)){if(lengthX){_.scrollLeft+=-lengthX*10}}else{if(lengthY){_.scrollTop+=-lengthY*10}}}var support=["wheel","mousewheel"].some(function(evtType){if(document["on"+evtType]!==undefined){this.element.addEventListener(evtType,wheelEvent);return true}}.bind(this));if(support){return}this.element.addEventListener("DOMMouseScroll",wheelEvent)};ScrollBar.prototype._getTouchEventListeners=function(){var _=this;var listeners=this._touchListeners;if(!listeners){listeners=this._touchListeners={startX:undefined,lastPageX:undefined,scrollTop:undefined,scrollLeft:undefined,startY:undefined,lastPageY:undefined,destroy:function(){this.startX=this.startY=undefined;this.lastPageX=this.lastPageY=undefined;this.scrollTop=this.scrollLeft=undefined}};listeners.touchstart=function(e){var pos=getMousePosition(e);listeners.startX=listeners.lastPageX=pos.pageX;listeners.startY=listeners.lastPageY=pos.pageY;listeners.scrollTop=this.scrollTop;listeners.scrollLeft=this.scrollLeft;userSelect(false)};listeners.touchmove=function(e){if(!listeners.startX||!listeners.startY){return}var pos=getMousePosition(e);var moveRatio=.8;if(Math.abs(pos.pageY-listeners.lastPageY)>=Math.abs(pos.pageX-listeners.lastPageX)){_.scrollTop+=-(pos.pageY-listeners.lastPageY)*moveRatio}else{_.scrollLeft+=-(pos.pageX-listeners.lastPageX)*moveRatio}listeners.lastPageY=pos.pageY;listeners.lastPageX=pos.pageX;e.preventDefault()};listeners.touchend=function(){listeners.destroy();userSelect(true)}}return listeners};ScrollBar.prototype._bindTouchScrollEvent=function(){if(!isTouchSupported()){return}var listeners=this._getTouchEventListeners();this.element.addEventListener("touchstart",listeners.touchstart,true);this.element.addEventListener("touchmove",listeners.touchmove,true);this.element.addEventListener("touchend",listeners.touchend,true);this.element.addEventListener("touchcancel",listeners.touchend,true)};ScrollBar.prototype.getScrollbarHeight=function(){var height=this.clientHeight,scrollHeight=this.scrollHeight;var barHeight=height/(scrollHeight/height);barHeight=Math.max(50,barHeight);return barHeight};ScrollBar.prototype.getScrollbarWidth=function(){var width=this.clientWidth,scrollWidth=this.scrollWidth;var barWidth=width/(scrollWidth/width);barWidth=Math.max(50,barWidth);return barWidth};ScrollBar.prototype._renderV=function(){var dom=document.createElement("div");dom.vScrollbar=true;this.vScrollbar=dom;dom.className=getFullClassName("scrollbar-ver");style(dom,{width:this.config.width+"px",display:"none","background-color":this.config.vTrackColor});var bar=this._createScrollBarBlock();style(bar,{"background-color":this.config.vScrollColor});dom.appendChild(bar);this.element.appendChild(dom)};function CellsModel(cellsModel){this.header={fields:[]};this.rows=[];this._eventListener={onAppendRows:[],onRefresh:[]};if(arguments.length>0){this.init(cellsModel)}}CellsModel.prototype.init=function(cellsModel){if(cellsModel.header&&cellsModel.header.fields instanceof Array){this.header.fields=cellsModel.header.fields}if(cellsModel.rows instanceof Array){this.rows=cellsModel.rows}var eventListener=cellsModel._eventListener;if(!eventListener){return}var context=this;["appendRows","refresh"].forEach(function(eventName){var listeners=eventListener[this.getEventKey(eventName)];if(listeners instanceof Array){listeners.forEach(function(listener){context.bind(eventName,listener)})}})};CellsModel.prototype.bind=function(eventName,listener){if(typeof eventName!=="string"||typeof listener!=="function"){return}eventName=this.getEventKey(eventName);if(eventName&&this._eventListener[eventName].indexOf(listener)===-1){this._eventListener[eventName].push(listener)}};CellsModel.prototype.getEventKey=function(eventName){if(eventName.length>1){eventName="on"+eventName[0].toUpperCase()+eventName.substring(1);if(this._eventListener[eventName]instanceof Array){return eventName}}return null};CellsModel.prototype.trigger=function(eventName){eventName=this.getEventKey(eventName);var listeners=this._eventListener[eventName];if(!(listeners instanceof Array)){return}listeners.forEach(function(listener){try{if(typeof listener==="function"){listener()}}catch(e){console.error(e)}})};CellsModel.prototype.refresh=function(){this.trigger("refresh")};CellsModel.prototype.appendRows=function(rows){this.rows=this.rows.concat(rows);this.trigger("appendRows")};function _setRenderTo(renderTo){if(typeof renderTo==="string"){renderTo=document.querySelector(renderTo)}if(!isDomElement(renderTo)){throw new TypeError("renderTo must be a dom element !")}this.renderTo=renderTo}var Cells=Class.create(function(cellsModel,config){init.apply(this,arguments)});function init(cellsModel,config){if(!(cellsModel instanceof CellsModel)){throw new TypeError("arguments must be instanceof CellsModel !")}Object.defineProperty(this,"cellsModel",{value:cellsModel});var renderTo=config.renderTo;delete config.renderTo;_setRenderTo.call(this,renderTo);this.config=Object.assign({enableCustomScroll:false,textTitle:false,colResize:false,rowResize:false,overflowX:false,overflowY:false},config);Object.freeze(this.config)}var _prototype=Cells.prototype;Cells.extend=function(extend){Object.keys(arguments[0]).forEach(function(key){_prototype[key]=extend[key]})};Cells.publishMethod=function(methodNames,instanceName){if(!methodNames||!instanceName){return}methodNames=[].concat(methodNames);methodNames.forEach(function(methodName){_prototype[methodName]=function(){var context=this[instanceName];var method=typeof methodName==="function"?methodName:context[methodName];if(typeof method==="function"){return method.apply(context,arguments)}}})};var CellsEvent=Class.create(function(cellsInstance){this.cellsInstance=cellsInstance;Object.defineProperty(this,"eventManager",{value:{}})});var _prototype$1=CellsEvent.prototype;_prototype$1.extendEventType=function(eventType,listeners){if(!listeners){listeners=[]}else{listeners=[].concat(listeners)}if(!this.eventManager[eventType]){this.eventManager[eventType]=listeners}};_prototype$1.getEventListeners=function(eventType){return this.eventManager[eventType]||[]};_prototype$1.existEventListener=function(eventType){var listeners=this.eventManager[eventType];return listeners&&listeners.length>0};CellsEvent.createEvent=function createEvent(eventType,target,data){return{type:eventType,target:target,data:data}};_prototype$1.addEventListener=function addEventListener(eventType,func){var handlers=this.eventManager[eventType];if(!handlers){handlers=this.eventManager[eventType]=[]}if(handlers.indexOf(func)===-1){handlers.push(func)}return this};_prototype$1.removeEventListener=function removeEventListener(eventType,func){var handlers=this.getEventListeners(eventType);if(!handlers){return}var index=handlers.indexOf(func);if(index>=0){handlers.splice(index,1);return func}};_prototype$1.triggerEvent=function triggerEvent(event){var eventType=event.type;var handlers=this.getEventListeners(eventType);if(!handlers){return}handlers.forEach(function(handler){requestAnimationFrame(function(){handler.call(event.target,event)})}.bind(this))};Cells.publishMethod(["addEventListener","removeEventListener","triggerEvent"],"cellsEvent");Cells.addInitHooks(function(){this.cellsEvent=new CellsEvent(this)});var _cellSupportStyles=["background","backgroundColor","backgroundImage","backgroundRepeat","backgroundSize"];var CellsRender=Class.create(function(cellsInstance){this.cellsInstance=cellsInstance;this.cellsPanel=null;this.headerPanel=null;this.bodyPanel=null;this.cursor=null;var cellsEvent=cellsInstance.cellsEvent;cellsEvent.extendEventType("renderFinished",[]);cellsEvent.extendEventType("click",[]);cellsEvent.extendEventType("cellClick",[]);cellsEvent.extendEventType("scroll",[]);cellsEvent.extendEventType("cellPainted",[])});var _prototype$2=CellsRender.prototype;function transformStyleName(styleName){return styleName.replace(/-(\w)/g,function(match,str){return str?str.toUpperCase():""})}CellsRender.expandSupportStyles=function(styleNames){if(styleNames){styleNames=[].concat(styleNames)}styleNames.forEach(function(styleName){styleName=transformStyleName[styleName];if(_cellSupportStyles.indexOf(styleName)===-1){_cellSupportStyles.push(styleName)}})};_prototype$2.initRenderState=function(){this.paintState={lastRowArea:null,currentRowArea:null,lastColArea:null,currentColArea:null,rowPaintAreas:null,colPaintAreas:null,reset:function(){this.lastRowArea=null;this.currentRowArea=null;this.lastColArea=null;this.currentColArea=null;this.rowPaintAreas=null;this.colPaintAreas=null}};this.domCache={clearCells:function(){this.headerCells.length=0;this.cells.length=0},headerCells:[],cells:[],colsWidth:[],colsLeft:[],rowsTop:[],rowsHeight:[],headerHeight:0}};function initRender(){var cellsInstance=this.cellsInstance;this.initRenderState();var renderTo=cellsInstance.renderTo;if(!renderTo||renderTo.nodeType!==1){throw new TypeError("parent container is invalid !")}var cellsPanel=this.cellsPanel=document.createElement("div");cellsPanel.className=getFullClassName();var dirtyPanel=renderTo.querySelector(getFullClassSelector());dirtyPanel&&renderTo.removeChild(dirtyPanel);cellsPanel.appendChild(this._createHeader());cellsPanel.appendChild(this._createBodyContainer());renderTo.appendChild(cellsPanel);var config=cellsInstance.config;var scrollbar=config.enableCustomScroll?new ScrollBar(this.bodyPanel,{overflowX:config.overflowX,overflowY:config.overflowY}):this.bodyPanel;Object.defineProperty(this,"scrollbar",{configurable:true,get:function(){return scrollbar}});this._createCursor();this.bindEvent()}var headerContentClassName="header-content";_prototype$2._initPanelSize=function(){var cellsPanel=this.cellsPanel;cellsPanel.currentWidth=this.headerPanel.clientWidth;cellsPanel.currentHeight=cellsPanel.clientHeight};_prototype$2.getPanelSize=function(){return{width:this.cellsPanel.currentWidth,height:this.cellsPanel.currentHeight}};_prototype$2.resizeScrollbar=function resizeScrollbar(){var cellsInstance=this.cellsInstance;if(cellsInstance.config.enableCustomScroll){this.scrollbar.resize();return}};_prototype$2.getCurrentColArea=function getCurrentColArea(){var cellsInstance=this.cellsInstance;var scrollbar=this.scrollbar;var panelSize=this.getPanelSize();var colsLeft=this.domCache.colsLeft;var left=scrollbar.scrollLeft;return this.getThresholdArea(panelSize.width,colsLeft,left)};_prototype$2.getThresholdArea=function getThresholdArea(viewSize,positions,cursor){var from=0,end,i;if(!positions.some(function(position,index){if(position>=cursor){from=index;return true}})){from=positions.length-1}var mid=from;for(i=mid;i>=0;i--){if(positions[mid]-positions[i]>=viewSize){break}}from=Math.max(0,i);for(i=mid;i<positions.length;i++){if(positions[i]-positions[mid]>viewSize){break}}end=Math.min(positions.length,i);var area={from:from,pageSize:end-from};return this.normalizeArea(area,positions)};_prototype$2.getCurrentRowArea=function getCurrentRowArea(){var cellsInstance=this.cellsInstance;var scrollbar=this.scrollbar;var panelSize=this.getPanelSize();var rowsTop=this.domCache.rowsTop;var top=scrollbar.scrollTop;return this.getThresholdArea(panelSize.height,rowsTop,top)};_prototype$2.getRowPaintAreas=function getRowPaintAreas(){return this._getPaintAreas("row")};_prototype$2.getColPaintAreas=function getColPaintAreas(){return this._getPaintAreas("col")};_prototype$2.normalizeArea=function(area,positions){area.from=Math.max(0,area.from);area.from=Math.min(positions.length-1,area.from);area.pageSize=Math.max(0,area.pageSize);area.pageSize=Math.min(positions.length-area.from,area.pageSize);return area};_prototype$2._getPaintAreas=function _getPaintAreas(type){var paintState=this.paintState;var lastArea=type==="row"?paintState.lastRowArea:paintState.lastColArea,curArea=type==="row"?paintState.currentRowArea:paintState.currentColArea;var domCache=this.domCache;var positions=type==="row"?domCache.rowsTop:domCache.colsLeft;var areas=[];if(lastArea==null){areas.push(curArea);return areas}if(lastArea.from===curArea.from&&lastArea.pageSize===curArea.pageSize){return areas}var area;if(curArea.from>=lastArea.from){if(lastArea.from+lastArea.pageSize<=curArea.from){areas.push(curArea)}else{area=this.normalizeArea({from:lastArea.from+lastArea.pageSize,pageSize:curArea.from+curArea.pageSize-(lastArea.from+lastArea.pageSize)},positions);if(area.pageSize>0){areas.push(area)}}}else{if(curArea.from+curArea.pageSize<=lastArea.from){areas.push(curArea)}else{area=this.normalizeArea({from:curArea.from,pageSize:lastArea.from-curArea.from},positions);if(area.pageSize>0){areas.push(area)}var bottomDis=curArea.from+curArea.pageSize-(lastArea.from+lastArea.pageSize);if(bottomDis>0){area=this.normalizeArea({from:lastArea.from+lastArea.pageSize,pageSize:bottomDis},positions);if(area.pageSize>0){areas.push(area)}}}}return areas};_prototype$2.initPaint=function(){var cellsInstance=this.cellsInstance;var domCache=this.domCache;var cells=cellsInstance.renderTo.querySelectorAll(getFullClassSelector("cell")),size=cells.length;for(var i=0;i<size;i++){this.removeElementFromDom(cells[i])}domCache.clearCells();var paintState=this.paintState;paintState.reset()};_prototype$2.executePaint=function(){var paintState=this.paintState;paintState.currentRowArea=this.getCurrentRowArea();paintState.currentColArea=this.getCurrentColArea();paintState.rowPaintAreas=this.getRowPaintAreas();paintState.colPaintAreas=this.getColPaintAreas();this.paintHeader();this.paintBody();paintState.lastRowArea=paintState.currentRowArea;paintState.lastColArea=paintState.currentColArea};_prototype$2.getHeaderContentPanel=function(){var headerContentPanel=this.headerPanel._contentPanel;return headerContentPanel};_prototype$2.getHeaderCells=function(){return this.domCache.headerCells};_prototype$2.getBodyCells=function(){return this.domCache.cells};_prototype$2.paintHeader=function paintHeader(){var cellsInstance=this.cellsInstance,cellsModel=cellsInstance.cellsModel,cellsCache=this.domCache.headerCells,headerContentPanel=this.getHeaderContentPanel();var paintState=this.paintState;var colPaintAreas=[].concat(paintState.colPaintAreas),colClientArea=paintState.currentColArea;var cells=cellsCache.filter(function(cell){var col=parseInt(cell.getAttribute("col"));var inCol=col>=colClientArea.from&&col<colClientArea.from+colClientArea.pageSize;return!inCol});var fields=cellsModel.header.fields;colPaintAreas.forEach(function(colArea){var cell,field;for(var colIndex=colArea.from;colIndex<colArea.from+colArea.pageSize;colIndex++){field=fields[colIndex];cell=cells.pop();if(!cell){cell=this._createHeaderCell(0,colIndex,field);headerContentPanel.appendChild(cell)}else{this._paintCell(cell,0,colIndex,field)}}}.bind(this));this.removeCells(cellsCache,cells)};_prototype$2.paintBody=function paintBody(){var cellsInstance=this.cellsInstance;var paintState=this.paintState,domCache=this.domCache,rows=cellsInstance.cellsModel.rows;var rowPaintAreas=[].concat(paintState.rowPaintAreas),colPaintAreas=[].concat(paintState.colPaintAreas);var rowClientArea=paintState.currentRowArea,colClientArea=paintState.currentColArea;var cacheCells=domCache.cells;var cells=cacheCells.filter(function(cell){var r=parseInt(cell.getAttribute("row")),col=parseInt(cell.getAttribute("col"));var inRow=r>=rowClientArea.from&&r<rowClientArea.from+rowClientArea.pageSize,inCol=col>=colClientArea.from&&col<colClientArea.from+colClientArea.pageSize;return!inRow||!inCol});if(rowPaintAreas.length===0&&colPaintAreas.length===0){this.removeCells(cacheCells,cells);return}if(rowPaintAreas.length===0){rowPaintAreas.push(rowClientArea)}if(colPaintAreas.length===0){colPaintAreas.push(colClientArea)}var contentPanel=this.bodyPanel._contentPanel;rowPaintAreas.forEach(function(area){var row;for(var rowIndex=area.from;rowIndex<area.from+area.pageSize;rowIndex++){row=rows[rowIndex];colPaintAreas.forEach(function(colArea){var cell,field;for(var colIndex=colArea.from;colIndex<colArea.from+colArea.pageSize;colIndex++){field=row.fields[colIndex];cell=cells.pop();if(!cell){cell=this._createCell(rowIndex,colIndex,field);contentPanel.appendChild(cell)}else{this._paintCell(cell,rowIndex,colIndex,field)}}}.bind(this))}}.bind(this));this.removeCells(cacheCells,cells)};_prototype$2.removeCells=function removeCells(cacheCells,cells){var _=this;cells.forEach(function(cell){cacheCells.splice(cacheCells.indexOf(cell),1);_.removeElementFromDom(cell)})};_prototype$2.removeElementFromDom=function(cell){if(cell.remove){cell.remove()}else if(cell.parentNode){cell.parentNode.removeChild(cell)}};_prototype$2.computeRowTop=function computeRowTop(row){var rowsTop=this.domCache.rowsTop;return rowsTop[row]};_prototype$2._paintCell=function _paintCell(cell,row,col,field){cell.setAttribute("row",""+row);cell.setAttribute("col",""+col);this._configCell(cell,field);this._reLayoutCell(cell)};_prototype$2.emptyElement=function(element){while(element.firstChild){this.removeElementFromDom(element.firstChild)}};_prototype$2._configCell=function _configCell(cell,field){var cellsInstance=this.cellsInstance;var isHtml=typeof field.html==="string";cell.setAttribute("html_content",isHtml+"");if(isHtml){cell.innerHTML=field.html;cell._textSpan=null}else{var text=field.name||field.value;var span;if(!cell._textSpan){cell.innerHTML="";span=document.createElement("span");cell.appendChild(span);cell._textSpan=span}else{span=cell._textSpan}span.innerText=text;if(cellsInstance.config.textTitle){cell.setAttribute("title",text)}}return cell};_prototype$2._createHeaderCell=function(row,col,field){return this._createCell(row,col,field,true)};_prototype$2._createCell=function _createCell(row,col,field,isHeaderCell){var cacheCells=isHeaderCell?this.domCache.headerCells:this.domCache.cells;var cell=document.createElement("div");cell._cell=true;cell._headerCell=isHeaderCell;cell.setAttribute("row",""+row);cell.setAttribute("col",""+col);var classNames=[getFullClassName("cell")];cell.className=classNames.join(" ");this._configCell(cell,field);this._reLayoutCell(cell);cacheCells.push(cell);return cell};_prototype$2._reLayoutCell=function _reLayoutCell(cell){var cellsInstance=this.cellsInstance;var row=parseInt(cell.getAttribute("row")),col=parseInt(cell.getAttribute("col"));var domCache=this.domCache,colsLeft=domCache.colsLeft,colsWidth=domCache.colsWidth,rowsHeight=domCache.rowsHeight;var cellsModel=cellsInstance.cellsModel,headerFields=cellsModel.header.fields,rows=cellsModel.rows,header=cellsModel.header;var colLast=String(headerFields.length-1===col),rowLast=String(rows.length-1===row);
cell.setAttribute("col-last",colLast);cell.setAttribute("row-last",rowLast);style(cell,{left:colsLeft[col]+"px",top:this.computeRowTop(row)+"px",width:colsWidth[col]+"px",height:rowsHeight[row]+"px"});if(cell._customStyleKeys){cell._customStyleKeys.forEach(function(key){style(cell,key,"")})}var fields=cell._headerCell?header.fields:rows[row].fields,field=fields[col];var fieldStyle=field.style;var customStyleKeys=[];if(fieldStyle){Object.keys(fieldStyle).forEach(function(key){if(key in cell.style){if(_cellSupportStyles.indexOf(transformStyleName(key))===-1){return}style(cell,key,fieldStyle[key]);customStyleKeys.push(key)}})}cell._customStyleKeys=customStyleKeys};_prototype$2._createCursor=function _createCursor(){var cursor=document.createElement("i");cursor.className=getFullClassName("row-cursor");this.cursor=cursor;this.bodyPanel._contentPanel.appendChild(cursor);return cursor};_prototype$2._createBodyContainer=function _createBodyContainer(){var cellsInstance=this.cellsInstance;var bodyContainer=this.bodyPanel=document.createElement("div");bodyContainer.className=getFullClassName("body-container");bodyContainer.setAttribute("overflowX",String(cellsInstance.config.overflowX));bodyContainer.setAttribute("overflowY",String(cellsInstance.config.overflowY));var rowContainer=this._createRowContainer();bodyContainer.appendChild(rowContainer);bodyContainer._contentPanel=rowContainer;return bodyContainer};_prototype$2._createRowContainer=function _createRowContainer(){var rowContainer=document.createElement("div");rowContainer.className=getFullClassName("row-container");return rowContainer};_prototype$2._createHeader=function _createHeader(){var headerContainer=document.createElement("header");headerContainer.className=getFullClassName("header");this.headerPanel=headerContainer;var headerContentPanel=document.createElement("div");headerContentPanel.className=getFullClassName(headerContentClassName);headerContainer.appendChild(headerContentPanel);headerContainer._contentPanel=headerContentPanel;return headerContainer};_prototype$2.syncCursor=function syncCursor(){var cursor=this.cursor;if(!cursor){return}var domCache=this.domCache;var rowsTop=domCache.rowsTop,rowsHeight=domCache.rowsHeight,colsLeft=domCache.colsLeft,colsWidth=domCache.colsWidth;var curTop=rowsTop[rowsTop.length-1]+rowsHeight[rowsHeight.length-1],curWidth=colsLeft[colsLeft.length-1]+colsWidth[colsWidth.length-1];style(cursor,{width:curWidth+"px",top:curTop+"px"});executeFunctionDelay("resizeScrollbar",this.resizeScrollbar,this)};_prototype$2._initCellSizeIndex=function(){this._initCellWidthIndex();this._initCellHeightIndex()};_prototype$2._initCellWidthIndex=function(){var cellsModel=this.cellsInstance.cellsModel,colsWidth=this.domCache.colsWidth,colsLeft=this.domCache.colsLeft;var maxWidth=0;cellsModel.header.fields.forEach(function(field,index){var colWidth=this._parseCellWidth(field.width);colsWidth[index]=colWidth;maxWidth+=colWidth;if(index===0){colsLeft[index]=0}else{colsLeft[index]=colsLeft[index-1]+colsWidth[index-1]}}.bind(this))};_prototype$2._initCellHeightIndex=function(startIndex){var domCache=this.domCache,cellsInstance=this.cellsInstance,cellsModel=cellsInstance.cellsModel;startIndex=startIndex||0;var rows=cellsModel.rows;var rowsTop=domCache.rowsTop,rowsHeight=domCache.rowsHeight;domCache.headerHeight=this._parseCellHeight(cellsModel.header.height);rows.slice(startIndex).forEach(function(row,index){index+=startIndex;var rowHeight=this._parseCellHeight(row.height);rowsHeight[index]=rowHeight;if(index===0){rowsTop[index]=0}else{rowsTop[index]=rowsTop[index-1]+rowsHeight[index-1]}}.bind(this))};_prototype$2._parseCellWidth=function(width){var panelSize=this.getPanelSize();var clientWidth=panelSize.width;if(typeof width==="string"&&width&&width.indexOf("%")===width.length-1){width=Math.floor(parseFloat(width)/100*clientWidth)}else{width=parseInt(width)}return isNaN(width)?100:width};_prototype$2._parseCellHeight=function(height){if(typeof height==="string"&&height&&height.indexOf("%")===height.length-1){var clientHeight=this.getPanelSize().height;height=Math.floor(parseFloat(height)/100*clientHeight)}else{height=parseInt(height)}return height?height:30};_prototype$2._onAppendRows=function(){var rowsHeight=this.domCache.rowsHeight;this._initCellHeightIndex(rowsHeight.length);this.syncCursor();executeFunctionDelay("repaintRequest",this.repaint,this)};_prototype$2._bindCellsModelEvent=function(){var cellsInstance=this.cellsInstance;cellsInstance.cellsModel.bind("refresh",function(){if(cellsInstance.renderTo){executeFunctionDelay("refresh",this.repaint,this)}}.bind(this));cellsInstance.cellsModel.bind("appendRows",function(){if(cellsInstance.renderTo){executeFunctionDelay("appendRows",this._onAppendRows,this)}}.bind(this))};_prototype$2.tiggerCellClickEvent=function tiggerCellClickEvent(cell){var cellsInstance=this.cellsInstance;var cellsModel=cellsInstance.cellsModel,cellsEvent=cellsInstance.cellsEvent,col=parseInt(cell.getAttribute("col"));if(cell._headerCell){cellsEvent.triggerEvent(CellsEvent.createEvent("cellClick",cell,cellsModel.header.fields[col]));return}var row=parseInt(cell.getAttribute("row"));var rowData=cellsModel.rows[row];if(rowData){cellsEvent.triggerEvent(CellsEvent.createEvent("cellClick",cell,rowData.fields[col]))}};function _bindScrollEvent(){var cellsInstance=this.cellsInstance,cellsEvent=cellsInstance.cellsEvent;var headerPanel=this.headerPanel,scrollbar=this.scrollbar;var headerContentPanel=headerPanel._contentPanel;scrollbar.addEventListener("scroll",function(){var scrollLeft=scrollbar.scrollLeft;style(headerContentPanel,"left",-scrollLeft+"px");executeFunctionDelay("repaintRequest",this.repaint,this);var event=CellsEvent.createEvent("scroll",scrollbar,cellsInstance.cellsModel);cellsEvent.triggerEvent(event)}.bind(this))}function _bindClickEvent(){var cellsInstance=this.cellsInstance,cellsEvent=cellsInstance.cellsEvent;var _=this,cellsPanel=this.cellsPanel;cellsPanel.addEventListener("click",function(e){var target=e.target;if(target===cellsPanel){cellsEvent.triggerEvent(CellsEvent.createEvent("click",cellsPanel,cellsInstance.cellsModel));return}if(cellsEvent.existEventListener("cellClick")){if(target._cell){_.tiggerCellClickEvent(target)}else{while(target=target.parentNode){if(target===cellsPanel){break}if(target._cell){_.tiggerCellClickEvent(target);break}}}}cellsEvent.triggerEvent(CellsEvent.createEvent("click",cellsPanel,cellsInstance.cellsModel))})}_prototype$2.bindEvent=function(){_bindScrollEvent.call(this);_bindClickEvent.call(this)};_prototype$2.render=function render(){initRender.apply(this);this._initPanelSize();this._initCellSizeIndex();this.headerHeight(this.domCache.headerHeight);this.executePaint();this.syncCursor();this.cellsInstance.triggerEvent(CellsEvent.createEvent("renderFinished",this))};_prototype$2.paint=function paint(){var domCache=this.domCache;this.initPaint();this._initPanelSize();this._initCellSizeIndex();this.headerHeight(domCache.headerHeight);this.executePaint();this.syncCursor()};_prototype$2.repaint=function repaint(){this.executePaint()};_prototype$2.headerHeight=function(height){var domCache=this.domCache;if(!height){return domCache.headerHeight}height=parseInt(height);if(typeof height!=="number"){return}domCache.headerHeight=height;this.headerPanel.style.height=height+"px"};_prototype$2.scrollTo=function(scrollTop,scrollLeft){var scrollbar=this.scrollbar;if(arguments.length===0){return{scrollLeft:scrollbar.scrollLeft,scrollTop:scrollbar.scrollTop}}scrollbar.scrollLeft=scrollLeft;scrollbar.scrollTop=scrollTop};CellsRender.addInitHooks(function(){this._bindCellsModelEvent()});Cells.publishMethod(["render","paint","repaint","scrollTo","headerHeight"],"cellsRender");Cells.addInitHooks(function(){this.cellsRender=new CellsRender(this)});var CellsResize=Class.create(function(cellsInstance){this.cellsInstance=cellsInstance});var _prototype$3=CellsResize.prototype;function isNumber(value){return typeof value==="number"}_prototype$3._updateRowDomCache=function(rowIndex,height){if(!isNumber(rowIndex=parseFloat(rowIndex))||!isNumber(height=parseFloat(height))){return}var cellsInstance=this.cellsInstance,cellsRender=cellsInstance.cellsRender,domCache=cellsRender.domCache;height=Math.max(0,height);if(rowIndex===-1){domCache.headerHeight=height;return}var rowsHeight=domCache.rowsHeight,rowsTop=domCache.rowsTop;rowsHeight[rowIndex]=height;for(var i=rowIndex+1;i<rowsTop.length;i++){rowsTop[i]=rowsTop[i-1]+rowsHeight[i-1]}};_prototype$3._updateColDomCache=function(colIndex,width){if(!isNumber(colIndex=parseFloat(colIndex))||!isNumber(width=parseFloat(width))){return}if(colIndex<0){return}var cellsInstance=this.cellsInstance,cellsRender=cellsInstance.cellsRender;var domCache=cellsRender.domCache;width=Math.max(0,width);var colsWidth=domCache.colsWidth,colsLeft=domCache.colsLeft;colsWidth[colIndex]=width;for(var i=colIndex+1;i<colsLeft.length;i++){colsLeft[i]=colsLeft[i-1]+colsWidth[i-1]}};_prototype$3._updateDomCache=function(rowIndex,colIndex,width,height){this._updateRowDomCache(rowIndex,height);this._updateColDomCache(colIndex,width)};_prototype$3.resizeRowHeight=function resizeRowHeight(rowIndex,height){this.resizeCell(rowIndex,null,null,height)};_prototype$3.resizeColWidth=function resizeColWidth(colIndex,width){this.resizeCell(null,colIndex,width,null)};_prototype$3._resizeCellDom=function _resizeCellDom(rowIndex,colIndex){this._updateHeaderCells(colIndex,{row:rowIndex===-1,col:colIndex>=0});this._updateBodyCells(rowIndex,colIndex,{row:rowIndex>=0,col:colIndex>=0})};_prototype$3._updateBodyCells=function(rowIndex,colIndex,option){var option=option||{row:false,col:false};if(!option.col&&!option.row){return}var cellsInstance=this.cellsInstance,cellsRender=cellsInstance.cellsRender;var domCache=cellsRender.domCache,rowsHeight=domCache.rowsHeight,rowsTop=domCache.rowsTop;var colsWidth=domCache.colsWidth,colsLeft=domCache.colsLeft;var cells=cellsRender.getBodyCells(),size=cells.length,cell,row,col;for(var i=0;i<size;i++){cell=cells[i];if(option.row){row=parseInt(cell.getAttribute("row"));if(row===rowIndex){cell.style.height=rowsHeight[row]+"px"}else if(row>rowIndex){cell.style.top=rowsTop[row]+"px"}}if(option.col){col=parseInt(cell.getAttribute("col"));if(col===colIndex){cell.style.width=colsWidth[col]+"px"}else if(col>colIndex){cell.style.left=colsLeft[col]+"px"}}}};_prototype$3._updateHeaderCells=function(colIndex,option){var option=option||{row:false,col:false};var cellsInstance=this.cellsInstance,cellsRender=cellsInstance.cellsRender,domCache=cellsRender.domCache;if(option.row){cellsRender.headerPanel.style.height=domCache.headerHeight+"px"}if(option.col){var colsWidth=domCache.colsWidth,colsLeft=domCache.colsLeft;var cells=cellsRender.getHeaderCells(),size=cells.length;var cell,col;for(var i=0;i<size;i++){cell=cells[i];col=parseInt(cell.getAttribute("col"));if(col===colIndex){cell.style.width=colsWidth[col]+"px"}else if(col>colIndex){cell.style.left=colsLeft[col]+"px"}}}};_prototype$3.resizeCell=function resizeCell(rowIndex,colIndex,width,height){this._updateDomCache(rowIndex,colIndex,width,height);this._resizeCellDom(rowIndex,colIndex,width,height)};var mouseHit=3;var cursors=["auto","ns-resize","ew-resize","nwse-resize"];function _bindResizeCellEvent(){var cellsInstance=this.cellsInstance,cellsRender=cellsInstance.cellsRender;var domCache=cellsRender.domCache,cellsPanel=cellsRender.cellsPanel,rowsTop=domCache.rowsTop,colsLeft=domCache.colsLeft,rowsHeight=domCache.rowsHeight,colsWidth=domCache.colsWidth;var _=this;function getMouseInfo(e){var colResize=cellsInstance.config.colResize,rowResize=cellsInstance.config.rowResize;var position=getMousePosition(e,cellsPanel);var relY,relX;var rowHit=0,colHit=0,rowIndex=undefined,colIndex=undefined;var scrollTo=cellsRender.scrollTo();if(rowResize){relY=position.pageY;var headerHeight=cellsInstance.headerHeight();if(Math.abs(relY-headerHeight)<mouseHit){rowHit=1;rowIndex=-1}else{relY-=headerHeight;rowsTop.some(function(rowTop,index){var h=rowsHeight[index];if(Math.abs(rowTop+h-scrollTo.scrollTop-relY)<mouseHit){rowHit=1;rowIndex=index;return true}})}}if(colResize){relX=position.pageX;colsLeft.some(function(colLeft,index){var w=colsWidth[index];if(Math.abs(colLeft+w-scrollTo.scrollLeft-relX)<mouseHit){colHit=2;colIndex=index;return true}})}var cursor=cursors[rowHit+colHit];return{cursor:cursor,position:position,rowIndex:rowIndex,colIndex:colIndex}}var resizeManager={lastPageX:undefined,lastPageY:undefined,rowIndex:undefined,colIndex:undefined,reset:function(){var resetX=this.resetX(),resetY=this.resetY();return resetX||resetY},resetX:function(){var bln=!!this.colIndex||!!this.lastPageX;this.lastPageX=this.colIndex=undefined;return bln},resetY:function(){var bln=!!this.rowIndex||!!this.lastPageY;this.lastPageY=this.rowIndex=undefined;return bln}};cellsPanel.addEventListener("mousemove",function(e){executeFunctionDelay("rowPanel-mousemove",function(){var mouseInfo=getMouseInfo(e);cellsPanel.style.cursor=mouseInfo.cursor})}.bind(this));cellsPanel.addEventListener("mousemove",function(e){var cellsInstance=this.cellsInstance;var mouseInfo=getMouseInfo(e);var rowIndex=resizeManager.rowIndex,colIndex=resizeManager.colIndex,width,height,resizeFlag=false;if(resizeManager.lastPageY!==undefined){height=mouseInfo.position.pageY-resizeManager.lastPageY+(rowIndex===-1?cellsInstance.headerHeight():rowsHeight[rowIndex]);resizeManager.lastPageY=mouseInfo.position.pageY;resizeFlag=true}if(resizeManager.lastPageX!==undefined){width=mouseInfo.position.pageX-resizeManager.lastPageX+colsWidth[colIndex];resizeManager.lastPageX=mouseInfo.position.pageX;resizeFlag=true}if(resizeFlag){this.resizeCell(rowIndex,colIndex,width,height);e.stopPropagation()}}.bind(this));cellsPanel.addEventListener("mousedown",function(e){var mouseInfo=getMouseInfo(e),resizeFlag=false;if(mouseInfo.rowIndex!==undefined){resizeManager.lastPageY=mouseInfo.position.pageY;resizeManager.rowIndex=mouseInfo.rowIndex;resizeFlag=true}else{resizeManager.resetY()}if(mouseInfo.colIndex!==undefined){resizeManager.lastPageX=mouseInfo.position.pageX;resizeManager.colIndex=mouseInfo.colIndex;resizeFlag=true}else{resizeManager.resetX()}if(resizeFlag){userSelect(false,this.cellsPanel)}}.bind(this));function mouseup(){userSelect(true,this.cellsPanel);if(resizeManager.reset()){cellsRender.syncCursor()}}cellsPanel.addEventListener("mouseup",mouseup.bind(this));cellsPanel.addEventListener("mouseleave",mouseup.bind(this))}_prototype$3.bindEvent=function(){_bindResizeCellEvent.call(this)};Cells.addInitHooks(function(){this.cellsResize=new CellsResize(this);this.addEventListener("renderFinished",function(){this.cellsResize.bindEvent()}.bind(this))});exports.global=global;exports.Class=Class;exports.ScrollBar=ScrollBar;exports.CellsModel=CellsModel;exports.Cells=Cells;exports.CellsEvent=CellsEvent;exports.CellsRender=CellsRender;exports.CellsResize=CellsResize;Object.defineProperty(exports,"__esModule",{value:true})});
